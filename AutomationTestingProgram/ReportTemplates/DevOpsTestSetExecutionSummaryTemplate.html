<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		</head>

	<body>
		<style>

            /* IF_EMAIL_THEN_DELETE */
            .failureAccordion {
                background-color: #eedcdc;
                cursor: pointer;
                text-align: left;
                outline: none;
                transition: 0.4s;
            }

			.testResults {
				padding: 0 18px;
				display: none;
				padding-right: 5px;
				padding-left: 5px;
				background-color: white;
				/* overflow: hidden; */
			}

			.resultsCol {
				display: none
			}
            /* IF_EMAIL_THEN_DELETE */


			.textfont {
				font-weight: normal;
				font-size: 12px;
				color: #000000;
				font-family: 'verdana', 'arial', 'helvetica', sans-serif
			}

			.owner {
				width: 100%;
				border-right: #6d7683 1px solid;
				border-top: #6d7683 1px solid;
				border-left: #6d7683 1px solid;
				border-bottom: #6d7683 1px solid;
				background-color: #a3a9b1;
				padding-top: 3px;
				padding-left: 3px;
				padding-right: 3px;
				padding-bottom: 10px
			}

			.product {
				color: white;
				font-size: 22px;
				font-family: 'arial', 'helvetica', 'geneva', 'swiss', 'sunsans-regular';
				background-color: #d18421;
				padding: 5px 10px;
				border-top: 5px solid #a9b2c5;
				border-right: 5px solid #a9b2c5;
				border-bottom: #293f6f;
				border-left: 5px solid #a9b2c5
			}

			.rest {
				color: white;
				font-size: 24px;
				font-family: 'arial', 'helvetica', 'geneva', 'swiss', 'sunsans-regular';
				background-color: white;
				padding: 10px;
				border-right: 5px solid #a9b2c5;
				border-bottom: 5px solid #a9b2c5;
				border-left: 5px solid #a9b2c5
			}

			.chl {
				font-size: 10px;
				font-weight: bold;
				background-color: #eee;
				padding-right: 5px;
				padding-left: 5px;
				width: 17%;
				height: 20px;
				border-bottom: 1px solid white
			}

			a {
				color: #336
			}

				a:hover {
					color: #724e6d
				}

			.ctext {
				font-size: 11px;
				padding-right: 5px;
				padding-left: 5px;
				width: 80%;
				height: 20px;
				border-bottom: 1px solid #eee
			}

			.hl {
				color: #724e6d;
				font-size: 12px;
				font-weight: bold;
				background-color: white;
				height: 20px;
				border-bottom: 2px dotted #a9b2c5
			}

			.space {
				height: 10px
			}

			h3 {
				font-weight: bold;
				font-size: 11px;
				color: white;
				font-family: 'verdana', 'arial', 'helvetica', sans-serif
			}
		</style>

		<table width="100%" border="0" cellspacing="0" cellpadding="0">
			<tbody>
				<tr>
					<td class="product">QA Regression Team Execution Centre</td>
				</tr>
				<tr>
					<td class="rest">
						<table class="space" width="100%" border="0" cellspacing="0" cellpadding="0">
							<tbody>
								<tr>
									<td />
								</tr>
							</tbody>
						</table>
						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<th class="hl" align="left">Test Plan Execution Summary</th>
								</tr>
								<tr>
									<th class="space" align="left" />
								</tr>
							</tbody>
						</table>
						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<td>
										<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center"
											   border="0">
											<tbody>
												<tr>
													<td class="chl" width="20%">Test Plan Name</td>
													<td class="ctext">
														<a href="https://dev.azure.com/{ORG_NAME}/{PROJECT_NAME}/_testPlans?planId={TEST_PLAN_ID}">
															{TEST_PLAN_NAME}
														</a>
													</td>

												</tr>
												<tr>
													<td class="chl" width="20%">Project Name</td>
													<td class="ctext">
														<a href="https://dev.azure.com/{ORG_NAME}/{PROJECT_NAME}">
															{PROJECT_NAME}
														</a>
													</td>
												</tr>
												<tr>
													<td class="chl" width="20%">Started</td>
													<td class="ctext">{STARTED_TIME}</td>
												</tr>
												<tr>
													<td class="chl" width="20%">Finished</td>
													<td class="ctext">{END_TIME}</td>
												</tr>
												<tr>
													<td class="chl" width="20%">Duration</td>
													<td class="ctext">{DURATION}</td>
												</tr>
												<tr>
													<td class="chl" width="20%">DevOps Release URL</td>
													<td class="ctext">
														<a href="{EXECUTION_URL}">
															{EXECUTION_URL}
														</a>
													</td>
												</tr>
												<tr>
													<td class="chl" width="20%">DevOps Run Summary</td>
													<td class="ctext">
														<a href="https://dev.azure.com/{ORG_NAME}/{PROJECT_NAME}/_TestManagement/Runs/?runId={TEST_RUN_ID}&_a=runCharts">
															https://dev.azure.com/{ORG_NAME}/{PROJECT_NAME}/_TestManagement/Runs/?runId={TEST_RUN_ID}&_a=runCharts
														</a>
													</td>
												</tr>
											</tbody>
										</table>
									</td>
								</tr>
								<tr>
									<td class="space" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<td>
										<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center"
											   border="0">
											<tbody>
												<tr>
													<td class="chl" style="width:14%">Blocked</td>
													<td class="chl" style="width:14%">Failed</td>
													<td class="chl" style="width:14%">N/A</td>
													<td class="chl" style="width:14%">No Run</td>
													<td class="chl" style="width:14%">Not Completed</td>
													<td class="chl" style="width:14%">Passed</td>
													<td class="chl" style="width:14%">Undelivered</td>
												</tr>
												<tr>
													<td class="ctext" style="width:14%">{TOTAL_BLOCKED}</td>
													<td class="ctext" style="width:14%">{TOTAL_FAILED}</td>
													<td class="ctext" style="width:14%">{TOTAL_NA}</td>
													<td class="ctext" style="width:14%">{TOTAL_NO_RUN}</td>
													<td class="ctext" style="width:14%">{TOTAL_NOT_COMPLETED}</td>
													<td class="ctext" style="width:14%">{TOTAL_PASSED}</td>
													<td class="ctext" style="width:14%">{TOTAL_UNDELIVERED}</td>
												</tr>
											</tbody>
										</table>
									</td>
								</tr>
								<tr>
									<td class="space" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<td>
										<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center"
											   border="0">
											<tbody>
												<tr>
													<td colspan="4" class="owner">
														<h3>Test Set ID ({TEST_SET_ID}) - {TEST_SET_NAME}</h3>
													</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Name:</td>
													<td class="ctext" style="width:35%">{TEST_SET_NAME}</td>
													<td class="chl" style="width:15%">Test Set ID</td>
													<td class="ctext" style="width:35%">
														<a href="https://dev.azure.com/{ORG_NAME}/{PROJECT_NAME}/_testPlans?planId={TEST_PLAN_ID}&suiteId={TEST_SET_ID}">
															{TEST_SET_ID}
														</a>
													</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Test Set Folder</td>
													<td class="ctext" style="width:35%">{TEST_SET_FOLDER}</td>
													<td class="chl" style="width:15%">Framework Type</td>
													<td class="ctext" style="width:35%">{FRAMEWORK_TYPE}</td>
												</tr>
												<tr>

													<td class="chl" style="width:15%">Target Cycle</td>
													<td class="ctext" style="width:35%">{TARGET_CYCLE}</td>
													<td class="chl" style="width:15%">Execution Format</td>
													<td class="ctext" style="width:35%">{EXECUTION_FORMAT}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Test Set Description</td>
													<td class="ctext" style="width:35%">{TEST_SET_DESCRIPTION}</td>
													<td class="chl" style="width:15%">Baseline</td>
													<td class="ctext" style="width:35%">{BASELINE}</td>
												</tr>
											</tbody>
										</table>
									</td>
								</tr>
								<tr>
									<td class="space" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<th class="hl" align="left">Machine Settings</th>
								</tr>
								<tr>
									<th class="space" align="left" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<td>
										<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center"
											   border="0">
											<tbody>
												<tr>
													<td class="chl" style="width:15%">Operating System</td>
													<td class="ctext" style="width:35%">{OPERATING_SYSTEM}</td>
													<td class="chl" style="width:15%">OS Build Number</td>
													<td class="ctext" style="width:35%">{OS_BUILD_NUMBER}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">OS Service Pack</td>
													<td class="ctext" style="width:35%">{OS_Service_Pack}</td>
													<td class="chl" style="width:15%">Processor</td>
													<td class="ctext" style="width:35%">{PROCESSOR}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Free Space on C Drive</td>
													<td class="ctext" style="width:35%">{FREE_SPACE_ON_C_DRIVE}</td>
													<td class="chl" style="width:15%">Ram Allocation</td>
													<td class="ctext" style="width:35%">{TOTAL_RAM}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Machine Name</td>
													<td class="ctext" style="width:35%">{MACHINE_NAME}</td>
													<td class="chl" style="width:15%">64 Bit Operating System</td>
													<td class="ctext" style="width:35%">{IS_64_BIT}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">User Domain</td>
													<td class="ctext" style="width:35%">{USER_DOMAIN}</td>
													<td class="chl" style="width:15%">User Name</td>
													<td class="ctext" style="width:35%">{USER_NAME}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Is Interactive</td>
													<td class="ctext" style="width:35%">{IS_USER_INTERACTIVE}</td>
													<td class="chl" style="width:15%">Process Path</td>
													<td class="ctext" style="width:35%">{PROCESS_PATH}</td>
												</tr>
											</tbody>
										</table>
									</td>
								</tr>
								<tr>
									<td class="space" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<th class="hl" align="left">Environment Setings</th>
								</tr>
								<tr>
									<th class="space" align="left" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<td>
										<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center"
											   border="0">
											<tbody>
												<tr>
													<td class="chl" style="width:15%">Application</td>
													<td class="ctext" style="width:35%">{APPLICATION}</td>
													<td class="chl" style="width:15%">Application Collection</td>
													<td class="ctext" style="width:35%">{APPLICATION_COLLECTION}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Test Environment</td>
													<td class="ctext" style="width:35%">{TEST_ENVIRONMENT}</td>
													<td class="chl" style="width:15%">Build Number</td>
													<td class="ctext" style="width:35%">{BUILD_NUMBER}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Test Framework Version</td>
													<td class="ctext" style="width:35%">{AUTOMATION_LIBRARY_VERSION}</td>
													<td class="chl" style="width:15%">Browser</td>
													<td class="ctext" style="width:35%">{BROWSER_VERSION}</td>
												</tr>
												<tr>
													<td class="chl" style="width:15%">Global Attempts</td>
													<td class="ctext" style="width:35%">{GLOBAL_ATTEMPTS}</td>
													<td class="chl" style="width:15%">Global Timeout (seconds)</td>
													<td class="ctext" style="width:35%">{GLOBAL_TIMEOUT}</td>
												</tr>
											</tbody>
										</table>
									</td>
								</tr>
								<tr>
									<td class="space" />
								</tr>
							</tbody>
						</table>

						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0">
							<tbody>
								<tr>
									<th class="hl" align="left">Executed Tests</th>
								</tr>
								<tr>
									<th class="space" align="left" />
								</tr>
							</tbody>
						</table>
						<table class="textfont" cellspacing="0" cellpadding="0" width="100%" align="center" border="0" id="ExecutedTestsTable">
							<tbody>
								<tr>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Run Name
									</td>

									<!--IF_EMAIL_THEN_DELETE-->
									<td class="resultsCol" style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Failure Details
									</td>
									<!--IF_EMAIL_THEN_DELETE-->

									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Status
									</td>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Tester
									</td>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Exec Date
									</td>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Exec Time
									</td>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Screenshot
									</td>
									<td style="font-size:10px;font-weight:bold;background-color:#eee;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid white">
										Number of Steps
									</td>
									<td style="font-size:11px;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid #eee"></td>
									<td style="font-size:11px;padding-right:5px;padding-left:5px;height:20px;border-bottom:1px solid #eee"></td>
								</tr>
								{Executed_Tests_Table_BODY}
							</tbody>
						</table>
					</td>
				</tr>
			</tbody>
		</table>

		<!-- IF_EMAIL_THEN_DELETE -->
		<script>
			var acc = document.getElementsByClassName("failureAccordion");

			var col = document.getElementsByClassName("resultsCol");

			var i, j;

			var hiddenPanels = document.getElementsByClassName("testResults");

			for (j = 0; j < acc.length; j++) { 
				acc[j].addEventListener("click", function () {

					this.classList.toggle("active");
					var panel = this.nextElementSibling;

					if (panel.style.display === "block") {
						panel.style.display = "none";

						// loop through every col and assign it to none
						for (i = 0; i < col.length; i++) {
							col[i].style.display = "none";
						}
					}
					else {
						panel.style.display = "block";

						// loop through every col and assign it to block
						for (i = 0; i < col.length; i++) {
							col[i].style.display = "block";
						}
					}
				});
			}

		</script>
		<!-- IF_EMAIL_THEN_DELETE -->

	</body>

</html>